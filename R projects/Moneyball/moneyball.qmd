---
title: "MoneyBall"
subtitle: "Helping Billy Beane (or Brad Pitt) to make it to the 2002 playoffs with the Oakland A's"
author: "David Desquens"
format: 
  html:
    code-fold: true
    code-tools: true
    df-print: paged
editor: visual
---

![](moneyball_title.jpg){fig-align="left"}

## Context & Background

*Source: [Wikipedia](https://en.wikipedia.org/wiki/Moneyball)*

#### **Rules of Baseball**

You don't need to know much about Baseball to understand the analysis. If you're totally unfamiliar with Baseball, check out this [useful explanatory video!](https://www.youtube.com/watch?v=0bKkGeROiPA)

#### **The 2002 Oakland A's**

The Oakland Athletics' 2002 season was the team's 35th in Oakland, California. It was also the 102nd season in franchise history. The Athletics finished first in the American League West with a record of 103-59.

The Athletics' 2002 campaign ranks among the most famous in franchise history. Following the 2001 season, Oakland saw the departure of three key players (the lost boys). Billy Beane, the team's general manager, responded with a series of under-the-radar free agent signings. The new-look Athletics, despite a comparative lack of star power, surprised the baseball world by besting the 2001 team's regular season record. The team is most famous, however, for winning 20 consecutive games between August 13 and September 4, 2002. The Athletics' season was the subject of Michael Lewis' 2003 book Moneyball: The Art of Winning an Unfair Game (as Lewis was given the opportunity to follow the team around throughout that season).

This project is based off the book written by Michael Lewis (later turned into a movie - see [the magic moment](https://youtu.be/yGf6LNWY9AI?si=zsLayKwV5YBw-Jqm)).

#### **Moneyball Book**

The central premise of book *Moneyball* is that the collective wisdom of baseball insiders (including players, managers, coaches, scouts, and the front office) over the past century is subjective and often flawed. Statistics such as stolen bases, runs batted in, and batting average, typically used to gauge players, are relics of a 19th-century view of the game and the statistics available at that time. The book argues that the Oakland A's' front office took advantage of more analytical gauges of player performance to field a team that could better compete against richer competitors in Major League Baseball (MLB).

Rigorous statistical analysis had demonstrated that on-base percentage and slugging percentage are better indicators of offensive success, and the A's became convinced that these qualities were cheaper to obtain on the open market than more historically valued qualities such as speed and contact. These observations often flew in the face of conventional baseball wisdom and the beliefs of many baseball scouts and executives.

By re-evaluating the strategies that produce wins on the field, the 2002 Athletics, with approximately US 44 million dollars in salary, were competitive with larger market teams such as the New York Yankees, who spent over US\$125 million in payroll that same season.

![](salary.png){fig-align="center"}

Because of the team's smaller revenues, Oakland is forced to find players undervalued by the market, and their system for finding value in undervalued players has proven itself thus far. This approach brought the A's to the playoffs in 2002 and 2003.

In this project we'll work with some data and with the goal of trying to find replacement players for the ones lost at the start of the off-season - During the 2001--02 offseason, the team lost three key free agents to larger market teams: 2000 AL MVP Jason Giambi to the New York Yankees, outfielder Johnny Damon to the Boston Red Sox, and closer Jason Isringhausen to the St. Louis Cardinals.

## Let's get started!

The main goal of this project is to help the Oakland A's recruit under-valued players!

![](Moneyball.jpg){fig-align="center"}

#### **Data prep**

We'll be using data from [Sean Lahaman's Website](http://www.seanlahman.com) a very useful source for baseball statistics. The documentation for the csv files that we will be using is located in the readme2013.txt file in the [github repo](https://github.com/ddesquens/ddesquens.github.io/tree/main/R%20projects/Moneyball). You may need to reference this to understand what acronyms stand for.

```{r}
#| label: load-packages-data-inputs
#| include: false


#######################################
# libraries & inputs
#######################################

#libraries
library(tidyverse)
library(plotly)
library(ggthemes)

#data inputs
batting <- read.csv('Batting.csv')
sal <- read.csv('Salaries.csv')
```

We know from literature that on-base percentage (`OBP`) and slugging percentage (`SLG`) are better indicators of offensive success, so we're calculating and adding them to our data, which is made of two data extracts that contain stats and salaries; we are merging them by `playerID` and `yearID`, illustrating a sample of the results as follows:

```{r}
#| label: data-prep


#######################################
# data prep
#######################################

#add features to data
batting$BA <- batting$H / batting$AB
batting <- batting %>% mutate(OBP = (H+BB+HBP)/(AB+BB+HBP+SF))
batting <- batting %>% mutate(X1B = H-X2B-X3B-HR)
batting <- batting %>% mutate(SLG = (X1B + 2*X2B + 3*X3B + 4*HR)/AB)

#remove data from batting (salaries data set only have data from 1985 onwards)
batting <- batting %>% filter(yearID>=1985)
#*to check that we have don't it correctly: arrange(distinct((batting %>% filter(yearID>=1985))['yearID']),yearID)

#merge both datasets batting and sal to combine player stats with salaries
combo <- merge(batting,sal,by=c('playerID','yearID'))

#show results
print(head(arrange(select(filter(combo,yearID==2001),playerID,teamID.x,AB,OBP,SLG,salary),desc(OBP*AB))))
```

```{r}
#| label: adhoc-calc
#| include: false

total.salaries <- round(sum((combo %>% subset(playerID %in% c('giambja01','damonjo01','saenzol01') & yearID==2001))$salary)/1e6,1)
```

#### **Analyzing the lost players and defining criteria for the search**

Is there anything we can learn from the lost players?\
First of all let's define the OA's budget to sign 3 new players. As per the chart below, the total in salaries for them in 2001 amounted to \$`r total.salaries`M. Let's say there's also available an additional amount to spend of about \$3.5M, which would result in a **total budget** of **\$15M** to sign 3 new players.

```{r}
#| label: lost-players


#######################################
# analyze lost players
#######################################

#get dataframe with 3 lost players
lost.players <- combo %>% subset(playerID %in% c('giambja01','damonjo01','saenzol01'))

#visualize trend of salaries through years
trendsal.lostplayers <- ggplot(filter(lost.players,yearID<2003),aes(yearID,round(salary/1e6,2))) + geom_line(aes(group=playerID,color=playerID)) + geom_point(aes(color=playerID)) + theme(plot.margin=0) + theme_calc() + labs(y='salary ($M)',x='season',caption='salary trend for the lost players up until 2002, after they moved to other teams in 2001')
trendsal.lostplayers
```

Other than the budget constrain, what are other variables that we should be focusing on among the entire dataset? Let's explore the relationships and correlations between variables:
